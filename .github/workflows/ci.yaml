name: GH Pages CI for live env

on:
  push:
    branches:
      - main


jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      - name: Install dependencies
        run: npm ci --save-dev
      - name: Check types
        run: npm run check
      - name: Build
        run: npm run build

 
  webhook-live:
    runs-on: ubuntu-latest
    needs: build
    if: ${{ success() }}
    steps:
    - name: Workflow Webhook Action Live
      uses: distributhor/workflow-webhook@v2.0.3
      env:
        webhook_type: 'json-extended'
        webhook_url: ${{ secrets.WEBHOOK_URL_LIVE }}/root/dev-tools/webhooks/dilewe_pipeline_live.sh
        webhook_secret: ${{ secrets.WEBHOOK_SECRET_DEV }}
        verbose: true
